plane
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'plane',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 826699087,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:15
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7693771666666667
car
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'car',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 874576990,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:17
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.6875011111111111
bird
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'bird',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 346164943,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:14
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7610291111111112
cat
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'cat',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 584288814,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:17
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.753850888888889
deer
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'deer',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 50062937,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:16
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7633177777777778
dog
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'dog',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 25449463,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:16
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7073548888888888
frog
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'frog',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 610607856,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:18
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7323528888888889
horse
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'horse',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 121388948,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:17
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.6309662222222222
ship
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'ship',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 401519378,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:19
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7198896111111112
truck
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/cosface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'truck',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/CosFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'CosFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'CosFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 235423549,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/cosface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/cosface/1/checkpoint/best.score.pth
last_epoch:16
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7348570000000001
plane
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'plane',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 398019980,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:5
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.8112118888888888
car
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'car',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 213797343,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:4
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.8513811666666666
bird
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'bird',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 818293806,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:4
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.5949455555555555
cat
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'cat',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 390116266,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:6
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.5402291666666666
deer
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'deer',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 801358820,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:5
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.47562811111111114
dog
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'dog',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 696556609,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:6
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.4852126666666667
frog
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'frog',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 875302050,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:4
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.49587088888888897
horse
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'horse',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 323554718,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:6
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.4344025555555555
ship
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'ship',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 137109035,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:3
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.8259918333333334
truck
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'truck',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/SphereFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'SphereFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'SphereFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 375849274,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/sphereface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/sphereface/1/checkpoint/best.score.pth
last_epoch:6
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.8415948333333334
plane
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'plane',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 894642382,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:10
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.609613
car
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'car',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 941882108,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:13
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.6421762777777777
bird
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'bird',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 916545566,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:10
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.4446743888888889
cat
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'cat',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 659935118,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:15
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.5772675
deer
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'deer',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 421893634,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:10
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.3560223888888889
dog
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'dog',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 280403732,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:18
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.5674196666666667
frog
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'frog',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 521866142,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:10
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.36621605555555553
horse
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'horse',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 29830140,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:16
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.40058705555555557
ship
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'ship',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 708219884,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:14
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.5889608888888889
truck
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/arcface/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'truck',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/ArcFace',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'ArcFace',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'ArcFace',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 333289522,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/arcface/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 20,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/arcface/1/checkpoint/best.score.pth
last_epoch:7
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7490594444444445
plane
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'plane',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 467336429,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:6
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'plane', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7797034444444445
car
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'car',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 895271022,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:7
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'car', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7168767777777778
bird
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'bird',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 194128665,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:8
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'bird', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.6480212777777777
cat
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'cat',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 809317227,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:10
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'cat', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.6777192777777777
deer
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'deer',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 396154954,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:7
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'deer', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.6272857222222222
dog
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'dog',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 917093333,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:10
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'dog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.6214975555555555
frog
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'frog',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 239003213,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:6
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'frog', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.628595888888889
horse
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'horse',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 44943518,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:9
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'horse', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.6589317777777779
ship
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'ship',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 864170375,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:7
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'ship', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7876802222222222
truck
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'train_dirs/cifar10/adacos/1/checkpoint/best.score.pth',
  'data': {'name': 'cifar10', 'num_classes': 10},
  'dataset': { 'name': 'CifarMetricDataset',
               'params': { 'anomaly_classes': 'truck',
                           'csv_filename': 'csvs/metric_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'mode': 'train', 'split': 'train'},
                           {'mode': 'validation', 'split': 'validation'},
                           {'mode': 'evaluation', 'split': 'get_embeddings'},
                           {'mode': 'evaluation', 'split': 'evaluation'},
                           {'mode': 'inference', 'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'distance': {'name': 'CosineDistanceHook'},
             'forward': {'name': 'DMLForwardHook'},
             'metric': {'name': 'DMLMetricHook'}},
  'inference': { 'batch_size': 128,
                 'cross_validation': True,
                 'output_path': 'outputs/cifar10/AdaCos',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'FocalLoss', 'params': {'gamma': 2}},
  'model': { 'name': 'AdaCos',
             'params': { 'encoder': 'resnet18',
                         'num_classes': 10,
                         'num_features': 512}},
  'model_name': 'AdaCos',
  'optimizer': { 'name': 'SGD',
                 'params': { 'lr': 0.001,
                             'momentum': 0.9,
                             'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'gamma': 0.95, 'step_size': 5}},
  'seed': 265196830,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/adacos/1',
             'gradient_accumulation_step': 1,
             'log_step': 2,
             'no_bias_decay': False,
             'num_epochs': 30,
             'num_keep_checkpoint': 1,
             'save_checkpoint_epoch': 1},
  'transform': { 'name': 'metric_transform',
                 'num_preprocessor': 8,
                 'params': {'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/adacos/1/checkpoint/best.score.pth
last_epoch:7
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'train', 'split': 'train'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'validation', 'split': 'validation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'get_embeddings'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'evaluation', 'split': 'evaluation'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
{'name': 'CifarMetricDataset', 'params': {'anomaly_classes': 'truck', 'csv_filename': 'csvs/metric_learning.csv', 'data_dir': 'data/cifar10', 'fold_idx': 1, 'num_folds': 2, 'mode': 'inference', 'split': 'inference'}}
[metric__transform] resize_to: (32, 32)
[metric__transform] do_flip: False
[metric_transform] tta: 1
[get_training_augmentation] resize_to: (32, 32)
[inference] AUC: 0.7025951666666665
plane
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'checkpoint/epoch_0100.pth',
  'data': {'name': 'cifar10'},
  'dataset': { 'name': 'CifarUnsvDataset',
               'params': { 'anomaly_classes': 'plane',
                           'csv_filename': 'csvs/unsv_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'folds': '0,', 'mode': 'train', 'split': 'train'},
                           { 'folds': '1,',
                             'mode': 'validation',
                             'split': 'validation'},
                           { 'folds': '1,',
                             'mode': 'evaluation',
                             'split': 'evaluation'},
                           { 'folds': '2,',
                             'mode': 'inference',
                             'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'forward': {'name': 'AEForwardHook'},
             'metric': {'name': 'AEMetricHook'}},
  'inference': { 'batch_size': 8,
                 'output_path': 'outputs/cifar10/L2AE',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'MSELoss', 'params': {}},
  'model': { 'name': 'AutoEncoder',
             'params': { 'image_size': 32,
                         'max_dim': 256,
                         'n_res_block': 2,
                         'z_dim': 100}},
  'model_name': 'L2AE',
  'optimizer': {'name': 'Adam', 'params': {'lr': 0.01, 'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'step_size': 50}},
  'seed': 458092334,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/l2ae',
             'gradient_accumulation_step': None,
             'image_log_step': 2,
             'log_step': 2,
             'num_epochs': 100,
             'num_keep_checkpoint': 10,
             'save_checkpoint_epoch': 10},
  'transform': { 'name': 'unsv_transform',
                 'num_preprocessor': 8,
                 'params': { 'is_flip': True,
                             'normalize': True,
                             'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/l2ae/checkpoint/epoch_0100.pth
car
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'checkpoint/epoch_0100.pth',
  'data': {'name': 'cifar10'},
  'dataset': { 'name': 'CifarUnsvDataset',
               'params': { 'anomaly_classes': 'car',
                           'csv_filename': 'csvs/unsv_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'folds': '0,', 'mode': 'train', 'split': 'train'},
                           { 'folds': '1,',
                             'mode': 'validation',
                             'split': 'validation'},
                           { 'folds': '1,',
                             'mode': 'evaluation',
                             'split': 'evaluation'},
                           { 'folds': '2,',
                             'mode': 'inference',
                             'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'forward': {'name': 'AEForwardHook'},
             'metric': {'name': 'AEMetricHook'}},
  'inference': { 'batch_size': 8,
                 'output_path': 'outputs/cifar10/L2AE',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'MSELoss', 'params': {}},
  'model': { 'name': 'AutoEncoder',
             'params': { 'image_size': 32,
                         'max_dim': 256,
                         'n_res_block': 2,
                         'z_dim': 100}},
  'model_name': 'L2AE',
  'optimizer': {'name': 'Adam', 'params': {'lr': 0.01, 'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'step_size': 50}},
  'seed': 931933126,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/l2ae',
             'gradient_accumulation_step': None,
             'image_log_step': 2,
             'log_step': 2,
             'num_epochs': 100,
             'num_keep_checkpoint': 10,
             'save_checkpoint_epoch': 10},
  'transform': { 'name': 'unsv_transform',
                 'num_preprocessor': 8,
                 'params': { 'is_flip': True,
                             'normalize': True,
                             'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/l2ae/checkpoint/epoch_0100.pth
bird
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'checkpoint/epoch_0100.pth',
  'data': {'name': 'cifar10'},
  'dataset': { 'name': 'CifarUnsvDataset',
               'params': { 'anomaly_classes': 'bird',
                           'csv_filename': 'csvs/unsv_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'folds': '0,', 'mode': 'train', 'split': 'train'},
                           { 'folds': '1,',
                             'mode': 'validation',
                             'split': 'validation'},
                           { 'folds': '1,',
                             'mode': 'evaluation',
                             'split': 'evaluation'},
                           { 'folds': '2,',
                             'mode': 'inference',
                             'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'forward': {'name': 'AEForwardHook'},
             'metric': {'name': 'AEMetricHook'}},
  'inference': { 'batch_size': 8,
                 'output_path': 'outputs/cifar10/L2AE',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'MSELoss', 'params': {}},
  'model': { 'name': 'AutoEncoder',
             'params': { 'image_size': 32,
                         'max_dim': 256,
                         'n_res_block': 2,
                         'z_dim': 100}},
  'model_name': 'L2AE',
  'optimizer': {'name': 'Adam', 'params': {'lr': 0.01, 'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'step_size': 50}},
  'seed': 788813337,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/l2ae',
             'gradient_accumulation_step': None,
             'image_log_step': 2,
             'log_step': 2,
             'num_epochs': 100,
             'num_keep_checkpoint': 10,
             'save_checkpoint_epoch': 10},
  'transform': { 'name': 'unsv_transform',
                 'num_preprocessor': 8,
                 'params': { 'is_flip': True,
                             'normalize': True,
                             'resize_to': '(32, 32)'}}}
load checkpoint from train_dirs/cifar10/l2ae/checkpoint/epoch_0100.pth
cat
alexnet is already registered in backbone
resnet18 is already registered in backbone
resnet34 is already registered in backbone
resnet50 is already registered in backbone
resnet101 is already registered in backbone
resnet152 is already registered in backbone
vgg11 is already registered in backbone
vgg11_bn is already registered in backbone
vgg13 is already registered in backbone
vgg13_bn is already registered in backbone
vgg16 is already registered in backbone
vgg16_bn is already registered in backbone
vgg19_bn is already registered in backbone
vgg19 is already registered in backbone
squeezenet1_0 is already registered in backbone
squeezenet1_1 is already registered in backbone
InceptionOutputs is already registered in backbone
densenet121 is already registered in backbone
densenet169 is already registered in backbone
densenet201 is already registered in backbone
densenet161 is already registered in backbone
GoogLeNetOutputs is already registered in backbone
------------------------------------------------
inference
{ 'backbone': {'name': 'resnet18', 'params': {'pretrained': True}},
  'checkpoint': 'checkpoint/epoch_0100.pth',
  'data': {'name': 'cifar10'},
  'dataset': { 'name': 'CifarUnsvDataset',
               'params': { 'anomaly_classes': 'cat',
                           'csv_filename': 'csvs/unsv_learning.csv',
                           'data_dir': 'data/cifar10',
                           'fold_idx': 1,
                           'num_folds': 2},
               'splits': [ {'folds': '0,', 'mode': 'train', 'split': 'train'},
                           { 'folds': '1,',
                             'mode': 'validation',
                             'split': 'validation'},
                           { 'folds': '1,',
                             'mode': 'evaluation',
                             'split': 'evaluation'},
                           { 'folds': '2,',
                             'mode': 'inference',
                             'split': 'inference'}]},
  'evaluation': {'batch_size': 128},
  'hooks': { 'forward': {'name': 'AEForwardHook'},
             'metric': {'name': 'AEMetricHook'}},
  'inference': { 'batch_size': 8,
                 'output_path': 'outputs/cifar10/L2AE',
                 'reference_csv_filename': 'data/cifar10/csvs/example.csv',
                 'split': 'inference'},
  'loss': {'name': 'MSELoss', 'params': {}},
  'model': { 'name': 'AutoEncoder',
             'params': { 'image_size': 32,
                         'max_dim': 256,
                         'n_res_block': 2,
                         'z_dim': 100}},
  'model_name': 'L2AE',
  'optimizer': {'name': 'Adam', 'params': {'lr': 0.01, 'weight_decay': 0.0005}},
  'scheduler': {'name': 'StepLR', 'params': {'step_size': 50}},
  'seed': 947430643,
  'train': { 'batch_size': 128,
             'dir': 'train_dirs/cifar10/l2ae',
             'gradient_accumulation_step': None,
             'image_log_step': 2,
             'log_step': 2,
             'num_epochs': 100,
             'num_keep_checkpoint': 10,
             'save_checkpoint_epoch': 10},
  'transform': { 'name': 'unsv_transform',
                 'num_preprocessor': 8,
                 'params': { 'is_flip': True,
                             'normalize': True,
                             'resize_to': '(32, 32)'}}}
plane
